name: Docker Image CI
on:
  push:
    branches: [ kiterfoo-a-effacer ]
  pull_request:
    branches: [ kiterfoo-a-effacer ]
jobs:
 # push-image-to-docker-hub:  # job name
  build:
    runs-on: ubuntu-latest
    steps:
      - name: "action"
        uses: actions/checkout@master
      - name: Get current date # get la date du build
        id: date
        run: echo "::set-output name=date::$(date +'%Y-%m-%d--%M-%S')"
      - name: connexion, build et puch to dockerhub
        run: |
          echo ${{ DOCKER_HUB_USERNAME }}"/shibbolethsp"
          echo "${{ secrets.DOCKER_HUB_ACCESS_TOKEN }}" | docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} --password-stdin
          docker build . --file Dockerfile --tag kiterfoo/shibbolethsp:latest #construction du contener
          docker push kiterfoo/shibbolethsp:latest #puch du contener vers dockerhub
